# Schema Validation System

The `schema/` directory contains JSON Schema definitions that ensure the structural integrity and quality of all artifacts generated by the AdvancedRules AI orchestration framework. These schemas serve as the foundation for automated validation, ensuring consistency and compliance across all framework outputs.

## üéØ Purpose & Functionality

### Data Integrity Assurance
- **Structural Validation**: Ensures all artifacts follow consistent formats
- **Type Safety**: Validates data types and required fields
- **Quality Gates**: Prevents invalid artifacts from entering the system
- **Documentation**: Serves as living documentation for artifact structures

### Framework Consistency
- **Standardization**: Enforces consistent artifact formats across all AI personas
- **Interoperability**: Ensures artifacts can be processed by different framework components
- **Maintainability**: Provides clear contracts for artifact structures
- **Evolution**: Supports schema versioning and migration

## üìÅ Directory Structure

```
schema/
‚îú‚îÄ‚îÄ README.md                                   # This schema system overview
‚îú‚îÄ‚îÄ acceptance_criteria.schema.json             # Acceptance criteria validation
‚îú‚îÄ‚îÄ final_implementation_plan.frontmatter.schema.json # Implementation plan validation
‚îî‚îÄ‚îÄ validation_report.frontmatter.schema.json   # Validation report validation
```

## üìã Schema Definitions

### JSON Schema Files

#### `acceptance_criteria.schema.json`
**Purpose**: Validates project acceptance criteria artifacts

**Structure**:
```json
{
  "criteria": [
    {
      "id": "string|integer",
      "title": "string (required)",
      "description": "string",
      "priority": "string|integer",
      "tags": ["string"]
    }
  ]
}
```

**Usage**: Validates `memory-bank/plan/acceptance_criteria.json`

**Key Features**:
- Flexible ID types (string/integer)
- Required title field
- Optional description, priority, and tags
- Extensible with additional properties

#### `final_implementation_plan.frontmatter.schema.json`
**Purpose**: Validates final implementation plan frontmatter

**Structure**:
```json
{
  "title": "string",
  "date": "string",
  "version": "string|number",
  "tasks": [
    {
      "id": "string|integer",
      "summary": "string (required)",
      "owner": "string",
      "depends_on": ["string|integer"],
      "rollback": "string"
    }
  ]
}
```

**Usage**: Validates frontmatter in `Final_Implementation_Plan.md`

**Key Features**:
- Version tracking support
- Task dependency management
- Owner assignment
- Rollback planning

#### `validation_report.frontmatter.schema.json`
**Purpose**: Validates validation report frontmatter

**Structure**:
```json
{
  "title": "string",
  "date": "string",
  "version": "string|number",
  "status": "string",
  "validated_by": "string",
  "findings": [
    {
      "severity": "string",
      "category": "string",
      "description": "string",
      "recommendation": "string"
    }
  ]
}
```

**Usage**: Validates frontmatter in `Validation_Report.md`

**Key Features**:
- Status tracking
- Severity classification
- Finding categorization
- Recommendation tracking

## üîß Validation System

### Automated Validation
```bash
# Validate all artifacts against their schemas
python3 ../tools/schema/validate_artifacts.py

# Validate specific artifact
python3 ../tools/schema/validate_artifacts.py --artifact acceptance_criteria

# Validate with detailed output
python3 ../tools/schema/validate_artifacts.py --verbose

# Validate only memory-bank artifacts
python3 ../tools/schema/validate_artifacts.py --scope memory-bank
```

### Validation Process
1. **Schema Loading**: Loads appropriate schema for artifact type
2. **Structure Validation**: Validates JSON/YAML structure against schema
3. **Type Checking**: Ensures all fields have correct data types
4. **Required Fields**: Verifies all mandatory fields are present
5. **Constraint Validation**: Checks field constraints and enumerations
6. **Report Generation**: Produces detailed validation reports

### Error Handling
- **Descriptive Errors**: Clear error messages with specific validation failures
- **Context Information**: Provides artifact location and field context
- **Recovery Suggestions**: Offers guidance for fixing validation errors
- **Non-blocking Mode**: Can continue validation despite individual failures

## üìä Schema Architecture

### Schema Design Principles
- **Modular Design**: Each artifact type has its own schema
- **Extensibility**: Additional properties allowed for future enhancements
- **Version Compatibility**: Supports schema evolution and versioning
- **Documentation**: Self-documenting schemas with clear field descriptions

### Schema Types
- **JSON Schemas**: For JSON artifacts (acceptance_criteria.json)
- **Frontmatter Schemas**: For YAML frontmatter in Markdown files
- **Nested Structures**: Support for complex nested data structures
- **Array Validations**: Comprehensive array and object validations

### Schema Evolution
- **Version Tracking**: Schema versioning for compatibility
- **Migration Support**: Tools for migrating artifacts between schema versions
- **Deprecation Handling**: Graceful handling of deprecated fields
- **Backward Compatibility**: Maintains compatibility with older artifacts

## üöÄ Schema Development

### Creating New Schemas
1. **Identify Artifact**: Determine which artifact needs schema validation
2. **Define Structure**: Specify required and optional fields
3. **Create Schema**: Write JSON Schema following established patterns
4. **Add Validation**: Integrate with validation system
5. **Test Coverage**: Ensure comprehensive test coverage

### Schema File Conventions
```json
{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/schemas/[artifact].schema.json",
  "title": "Human-readable title",
  "type": "object",
  "properties": {
    // Field definitions
  },
  "required": ["mandatory_fields"],
  "additionalProperties": true
}
```

### Best Practices
- **Descriptive Titles**: Clear, descriptive schema titles
- **Comprehensive Descriptions**: Detailed field descriptions
- **Type Safety**: Explicit type definitions for all fields
- **Constraint Documentation**: Clear documentation of field constraints
- **Example Values**: Include example values in schema comments

## üîó Integration Points

### Framework Components
- **Memory Bank**: Validates all artifacts before storage
- **AI Personas**: Use schemas to ensure output quality
- **Decision Scoring**: Validates scoring inputs and outputs
- **Workflow Orchestration**: Validates state and transition data

### Development Workflow
- **Pre-commit Hooks**: Automatic validation before commits
- **CI/CD Pipeline**: Validation integrated into build process
- **IDE Integration**: Schema validation in development environment
- **Quality Gates**: Validation as part of deployment process

## üìà Monitoring & Maintenance

### Schema Metrics
- **Validation Success Rate**: Percentage of artifacts passing validation
- **Common Validation Errors**: Most frequent validation failures
- **Schema Coverage**: Percentage of artifacts covered by schemas
- **Performance Metrics**: Validation execution time and resource usage

### Maintenance Procedures
```bash
# Check schema validity
python3 ../tools/schema/validate_artifacts.py --validate-schemas

# Generate schema documentation
python3 ../tools/schema/validate_artifacts.py --generate-docs

# Audit schema usage
python3 ../tools/schema/validate_artifacts.py --audit
```

### Schema Updates
1. **Impact Assessment**: Evaluate impact of schema changes
2. **Migration Planning**: Plan artifact migration strategy
3. **Version Bumping**: Update schema version numbers
4. **Documentation Update**: Update schema documentation
5. **Testing**: Comprehensive testing of schema changes

## üö® Troubleshooting

### Common Validation Issues
- **Schema Not Found**: Ensure schema file exists and is accessible
- **Invalid JSON**: Check JSON syntax and formatting
- **Missing Required Fields**: Verify all mandatory fields are present
- **Type Mismatches**: Ensure field values match expected types
- **Constraint Violations**: Check field constraints and enumerations

### Debug Validation
```bash
# Enable verbose validation output
python3 ../tools/schema/validate_artifacts.py --verbose --debug

# Validate specific field
python3 ../tools/schema/validate_artifacts.py --artifact acceptance_criteria --field criteria

# Generate validation report
python3 ../tools/schema/validate_artifacts.py --report validation_report.json
```

## üéØ Future Enhancements

### Planned Improvements
- **Schema Registry**: Centralized schema management system
- **Version Control**: Advanced schema versioning and migration
- **Custom Validators**: Framework-specific validation rules
- **Performance Optimization**: Faster validation for large artifacts
- **Integration APIs**: REST APIs for external validation services

### Advanced Features
- **Conditional Validation**: Context-dependent validation rules
- **Cross-artifact Validation**: Validation across multiple artifacts
- **Semantic Validation**: Beyond structural validation
- **AI-assisted Validation**: AI-powered validation rule generation

---

**Schema Validation System** - Ensuring AdvancedRules artifact quality through comprehensive structural validation! üìã‚úÖ

*For framework usage, see the main [README](../README.md). For artifact validation, run `python3 ../tools/schema/validate_artifacts.py`.*